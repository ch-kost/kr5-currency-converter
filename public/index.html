<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; max-width: 720px; margin: 40px auto; padding: 0 16px; }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: end; }
    label { display: flex; flex-direction: column; gap: 6px; }
    input, select, button { padding: 10px 12px; font-size: 16px; }
    button { cursor: pointer; }
    pre { background: #f6f8fa; padding: 12px; border-radius: 10px; overflow: auto; }
  </style>
</head>
<body>
  <h1>üí± –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤–∞–ª—é—Ç (—Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—Å—ã)</h1>

  <div class="row">
    <label>
      –°—É–º–º–∞
      <input id="amount" type="number" value="10" min="0" step="0.01" />
    </label>

    <label>
      –ò–∑
      <select id="from"></select>
    </label>

    <label>
      –í
      <select id="to"></select>
    </label>

    <button onclick="convert()">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
  </div>

  <h3>–û—Ç–≤–µ—Ç</h3>
  <pre id="out">–ù–∞–∂–º–∏ ¬´–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å¬ª</pre>

  <script>
    async function loadRates() {
      const res = await fetch('/api/rates');
      const data = await res.json();
      const codes = data.supported || Object.keys(data.rates || {});

      const from = document.getElementById('from');
      const to = document.getElementById('to');
      from.innerHTML = '';
      to.innerHTML = '';

      for (const c of codes) {
        const o1 = document.createElement('option');
        o1.value = c; o1.textContent = c;
        from.appendChild(o1);

        const o2 = document.createElement('option');
        o2.value = c; o2.textContent = c;
        to.appendChild(o2);
      }
      from.value = 'USD';
      to.value = 'EUR';
    }

    async function convert() {
      const amount = document.getElementById('amount').value;
      const from = document.getElementById('from').value;
      const to = document.getElementById('to').value;

      const url = `/api/convert?from=${encodeURIComponent(from)}&to=${encodeURIComponent(to)}&amount=${encodeURIComponent(amount)}`;
      const res = await fetch(url);
      const data = await res.json();

      document.getElementById('out').textContent = JSON.stringify(data, null, 2);
    }

    loadRates();
  </script>
</body>
</html>
